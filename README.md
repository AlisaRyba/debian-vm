## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

**debian-vm/**

- **‚îú‚îÄ‚îÄ Vagrantfile** # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
- **‚îú‚îÄ‚îÄ configs/** # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **‚îÇ ‚îú‚îÄ‚îÄ nginx/**
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ chroot-default.conf** # –ö–æ–Ω—Ñ–∏–≥ Nginx –¥–ª—è chroot
- **‚îÇ ‚îú‚îÄ‚îÄ polkit/**
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ 10-network-manager.pkla** # –ü—Ä–∞–≤–∏–ª–∞ Network Manager
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ 20-package-management.pkla** # –ü—Ä–∞–≤–∏–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞–º–∏
- **‚îÇ ‚îú‚îÄ‚îÄ sudoers/**
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ helpdesk** # –ü—Ä–∞–≤–∞ helpdesk –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ netadmin** # –ü—Ä–∞–≤–∞ netadmin –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ pkg-management** # –ü—Ä–∞–≤–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞–º–∏
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ sysadmin** # –ü—Ä–∞–≤–∞ sysadmin –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **‚îÇ ‚îú‚îÄ‚îÄ sysctl/**
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ 99-kernel-security.conf** # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞
- **‚îÇ ‚îî‚îÄ‚îÄ kernel-security/** #–ö–æ–Ω—Ñ–∏–≥–∏ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ actions/** # –°–∫—Ä–∏–ø—Ç—ã –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ immediate-fixes.sh** # –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ kernel-recompile.sh** # –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —è–¥—Ä–∞
- **‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ reboot-required.sh** # –î–µ–π—Å—Ç–≤–∏—è, —Ç—Ä–µ–±—É—é—â–∏–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ systemd/** # Systemd —Å–ª—É–∂–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- **‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ kernel-security.service** # –°–ª—É–∂–±–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ kernel-security.timer** # –¢–∞–π–º–µ—Ä –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ automator.sh** # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–æ—Ä–∞
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ config.cfg** # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–æ—Ä–∞
- **‚îî‚îÄ‚îÄ scripts/** # –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- **‚îú‚îÄ‚îÄ common.sh** # –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã
- **‚îú‚îÄ‚îÄ main.sh** # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
- **‚îú‚îÄ‚îÄ setup_base.sh** # –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- **‚îú‚îÄ‚îÄ setup_users.sh** # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø
- **‚îú‚îÄ‚îÄ setup_services.sh** # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ (polkit, iptables, chroot)
- **‚îú‚îÄ‚îÄ setup_security.sh** # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **‚îú‚îÄ‚îÄ setup_kernel_security_automation.sh** # –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞
- **‚îî‚îÄ‚îÄ setup_kernel_hardening.sh** # –£—Å–∏–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –≥—Ä—É–ø–ø–∞–º–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ sudoers –∏ polkit
- –£—Å–∏–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞ Linux
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ iptables –∏ —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Chroot –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- ACL (Access Control Lists) –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞
- –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞

- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —è–¥—Ä–∞
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ security patches
- –ü–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏—è —è–¥—Ä–∞ - –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ - –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- Systemd —Ç–∞–π–º–µ—Ä—ã - —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫

## üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –≥—Ä—É–ø–ø—ã

### Company –≥—Ä—É–ø–ø–∞ (GID: 10000):

- **sysadmin** (UID: 10101) - –ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º—É
- **helpdesk** (UID: 10201) - –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **netadmin** (UID: 10301) - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç—å—é —á–µ—Ä–µ–∑ nmtui

### –ì—Ä—É–ø–ø—ã –æ—Ç–¥–µ–ª–æ–≤

- **marketing** - marketing_user, marketing_manager
- **sales** - sales_user, sales_manager
- **it** - it_admin, it_helpdesk

## üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —è–¥—Ä–∞

- JIT-–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä BPF –∑–∞—â–∏—â–µ–Ω –æ—Ç Spectre –∞—Ç–∞–∫
- –ó–∞–ø—Ä–µ—â–µ–Ω—ã ICMP –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø –∫ /proc/kallsyms
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω kexec –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω—ã user namespaces
- –û—Ç–∫–ª—é—á–µ–Ω Magic SysRq

### –°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- iptables —Å strict –ø–æ–ª–∏—Ç–∏–∫–æ–π
- –†–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ SSH –¥–æ—Å—Ç—É–ø
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º 80/443
- NAT –∏ —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏

### –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

- Polkit –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Network Manager
- Sudoers —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- ACL –¥–ª—è –¥–æ–º–∞—à–Ω–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ chroot

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞

## –ó–∞–ø—É—Å–∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã

`cd debian-vm`
`vagrant up`

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH

`vagrant ssh`

## –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π

`vagrant reload --provision`

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

`vagrant ssh -c "getent passwd | grep -E '(sysadmin|helpdesk|netadmin)'"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞

`vagrant ssh -c "sysctl net.core.bpf_jit_harden kernel.kptr_restrict"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

`vagrant ssh -c "systemctl status nginx"`
`vagrant ssh -c "iptables -L -n"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ chroot

`vagrant ssh -c "ls -la /srv/chroot/"`

# –†–∞–±–æ—Ç–∞ —Å setup_kernel_security_automation

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—á–µ—Ç–∞

`vagrant ssh -c "cat /etc/kernel-security/reports/weekly-report-20250921.md"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–ª—É–∂–±—ã

`vagrant ssh -c "systemctl status kernel-security.timer"`
`vagrant ssh -c "systemctl status kernel-security.service"`

## –ó–∞–ø—É—Å–∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

`vagrant ssh -c "/etc/kernel-security/automator.sh run"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

`vagrant ssh -c "sysctl net.core.bpf_jit_harden kernel.kptr_restrict kernel.dmesg_restrict"`

## –ó–∞–ø—É—Å–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

`vagrant ssh -c "/etc/kernel-security/automator.sh fix"`

## –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–æ—Ä–∞

`vagrant ssh -c "journalctl -u kernel-security.service -f"`

## –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —è–¥—Ä–∞

`vagrant ssh -c "sudo /etc/kernel-security/actions/kernel-recompile.sh"`
