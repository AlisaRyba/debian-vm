## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞:

**debian-vm/**

- **‚îú‚îÄ‚îÄ Vagrantfile** # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã
- **‚îú‚îÄ‚îÄ configs/** # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **‚îÇ ‚îú‚îÄ‚îÄ nginx/**
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ chroot-default.conf** # –ö–æ–Ω—Ñ–∏–≥ Nginx –¥–ª—è chroot
- **‚îÇ ‚îú‚îÄ‚îÄ polkit/**
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ 10-network-manager.pkla** # –ü—Ä–∞–≤–∏–ª–∞ Network Manager
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ 20-package-management.pkla** # –ü—Ä–∞–≤–∏–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞–º–∏
- **‚îÇ ‚îú‚îÄ‚îÄ sudoers/**
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ helpdesk** # –ü—Ä–∞–≤–∞ helpdesk –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ netadmin** # –ü—Ä–∞–≤–∞ netadmin –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ pkg-management** # –ü—Ä–∞–≤–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–∫–µ—Ç–∞–º–∏
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ sysadmin** # –ü—Ä–∞–≤–∞ sysadmin –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- **‚îÇ ‚îú‚îÄ‚îÄ sysctl/**
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ 99-kernel-security.conf** # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞
- **‚îÇ ‚îî‚îÄ‚îÄ kernel-security/** #–ö–æ–Ω—Ñ–∏–≥–∏ —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ actions/** # –°–∫—Ä–∏–ø—Ç—ã –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è —Å–∏—Å—Ç–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ immediate-fixes.sh** # –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ kernel-recompile.sh** # –°–∫—Ä–∏–ø—Ç –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —è–¥—Ä–∞
- **‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ reboot-required.sh** # –î–µ–π—Å—Ç–≤–∏—è, —Ç—Ä–µ–±—É—é—â–∏–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ systemd/** # Systemd —Å–ª—É–∂–±—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- **‚îÇ ‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ kernel-security.service** # –°–ª—É–∂–±–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **‚îÇ ‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ kernel-security.timer** # –¢–∞–π–º–µ—Ä –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏
- **‚îÇ ‚îÇ ‚îú‚îÄ‚îÄ automator.sh** # –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–æ—Ä–∞
- **‚îÇ ‚îÇ ‚îî‚îÄ‚îÄ config.cfg** # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–æ—Ä–∞
- **‚îî‚îÄ‚îÄ scripts/** # –°–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- **‚îú‚îÄ‚îÄ common.sh** # –û–±—â–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ —É—Ç–∏–ª–∏—Ç—ã
- **‚îú‚îÄ‚îÄ main.sh** # –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞
- **‚îú‚îÄ‚îÄ setup_base.sh** # –ë–∞–∑–æ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã
- **‚îú‚îÄ‚îÄ setup_users.sh** # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –≥—Ä—É–ø–ø
- **‚îú‚îÄ‚îÄ setup_services.sh** # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤ (polkit, iptables, chroot)
- **‚îú‚îÄ‚îÄ setup_security.sh** # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- **‚îú‚îÄ‚îÄ setup_kernel_security_automation.sh** # –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞
- **‚îú‚îÄ‚îÄ systemd-targets-setup.sh** # –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Multi-user.target –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- **‚îî‚îÄ‚îÄ setup_kernel_hardening.sh** # –£—Å–∏–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –≥—Ä—É–ø–ø–∞–º–∏
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ sudoers –∏ polkit
- –£—Å–∏–ª–µ–Ω–∏–µ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞ Linux
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ iptables –∏ —Å–µ—Ç–µ–≤–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- Chroot –æ–∫—Ä—É–∂–µ–Ω–∏–µ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤
- ACL (Access Control Lists) –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞
- –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

## –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞

- –ï–∂–µ–Ω–µ–¥–µ–ª—å–Ω—ã–π –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π —è–¥—Ä–∞
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á–µ—Ç–æ–≤ - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –æ—Ç—á–µ—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ Markdown
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è - –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ security patches
- –ü–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏—è —è–¥—Ä–∞ - –ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–µ - –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- Systemd —Ç–∞–π–º–µ—Ä—ã - —Ä–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø—Ä–æ–≤–µ—Ä–æ–∫

## üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –≥—Ä—É–ø–ø—ã

### Company –≥—Ä—É–ø–ø–∞ (GID: 10000):

- **sysadmin** (UID: 10101) - –ü–æ–ª–Ω—ã–µ –ø—Ä–∞–≤–∞ –Ω–∞ —Å–∏—Å—Ç–µ–º—É
- **helpdesk** (UID: 10201) - –°–º–µ–Ω–∞ –ø–∞—Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **netadmin** (UID: 10301) - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ç—å—é —á–µ—Ä–µ–∑ nmtui

### –ì—Ä—É–ø–ø—ã –æ—Ç–¥–µ–ª–æ–≤

- **marketing** - marketing_user, marketing_manager
- **sales** - sales_user, sales_manager
- **it** - it_admin, it_helpdesk

## üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —è–¥—Ä–∞

- JIT-–∫–æ–º–ø–∏–ª—è—Ç–æ—Ä BPF –∑–∞—â–∏—â–µ–Ω –æ—Ç Spectre –∞—Ç–∞–∫
- –ó–∞–ø—Ä–µ—â–µ–Ω—ã ICMP –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø –∫ /proc/kallsyms
- –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω kexec –∏ –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω—ã user namespaces
- –û—Ç–∫–ª—é—á–µ–Ω Magic SysRq

### –°–µ—Ç–µ–≤–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

- iptables —Å strict –ø–æ–ª–∏—Ç–∏–∫–æ–π
- –†–∞–∑—Ä–µ—à–µ–Ω —Ç–æ–ª—å–∫–æ SSH –¥–æ—Å—Ç—É–ø
- –û–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø –∫ –ø–æ—Ä—Ç–∞–º 80/443
- NAT –∏ —Ñ–æ—Ä–≤–∞—Ä–¥–∏–Ω–≥ –¥–ª—è –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–π —Å–µ—Ç–∏

### –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞

- Polkit –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è Network Manager
- Sudoers —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
- ACL –¥–ª—è –¥–æ–º–∞—à–Ω–∏—Ö –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –ò–∑–æ–ª—è—Ü–∏—è —Å–µ—Ä–≤–∏—Å–æ–≤ –≤ chroot

### –ó–∞—â–∏—Ç–∞ –æ—Ç Fork Bomb

#### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ —á–µ—Ä–µ–∑ limits.conf:

- –í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: soft=500, hard=1000 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏: –ø–æ–≤—ã—à–µ–Ω–Ω—ã–µ –ª–∏–º–∏—Ç—ã (sysadmin: soft=1000, hard=2000)
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å john: soft=400, hard=800 –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
- –ó–∞—â–∏—Ç–∞ –æ—Ç DoS-–∞—Ç–∞–∫ —á–µ—Ä–µ–∑ –∏—Å—á–µ—Ä–ø–∞–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤

### –£—Å–∏–ª–µ–Ω–Ω–∞—è –ø–∞—Ä–æ–ª—å–Ω–∞—è –ø–æ–ª–∏—Ç–∏–∫–∞ PAM

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ pam_cracklib:

- –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞: 12 —Å–∏–º–≤–æ–ª–æ–≤

##### –°–ª–æ–∂–Ω–æ—Å—Ç—å —Å–∏–º–≤–æ–ª–æ–≤:

- –ú–∏–Ω–∏–º—É–º 1 —Ü–∏—Ñ—Ä–∞ (dcredit=-1)
- –ú–∏–Ω–∏–º—É–º 1 –∑–∞–≥–ª–∞–≤–Ω–∞—è –±—É–∫–≤–∞ (ucredit=-1)
- –ú–∏–Ω–∏–º—É–º 1 —Å—Ç—Ä–æ—á–Ω–∞—è –±—É–∫–≤–∞ (lcredit=-1)
- –ú–∏–Ω–∏–º—É–º 1 —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª (ocredit=-1)

##### –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ—Å—Ç—ã—Ö –ø–∞—Ä–æ–ª–µ–π:

- –ó–∞–ø—Ä–µ—Ç —Å–ª–æ–≤–∞—Ä–Ω—ã—Ö —Å–ª–æ–≤ - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ—Ç–∏–≤ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–ª–æ–≤–∞—Ä—è
- –ó–∞–ø—Ä–µ—Ç –ø–∞–ª–∏–Ω–¥—Ä–æ–º–æ–≤ - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ —Å–∏–º–º–µ—Ç—Ä–∏—á–Ω—ã—Ö –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π
- –ó–∞–ø—Ä–µ—Ç –ø–æ–≤—Ç–æ—Ä—è—é—â–∏—Ö—Å—è —Å–∏–º–≤–æ–ª–æ–≤ - –Ω–µ –±–æ–ª–µ–µ 3 –æ–¥–∏–Ω–∞–∫–æ–≤—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤ –ø–æ–¥—Ä—è–¥
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–ª–∏—á–∏—è –æ—Ç —Å—Ç–∞—Ä–æ–≥–æ –ø–∞—Ä–æ–ª—è - –º–∏–Ω–∏–º—É–º 5 —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
- –ó–∞–ø—Ä–µ—Ç –ø–∞—Ä–æ–ª–µ–π, —Å–æ–¥–µ—Ä–∂–∞—â–∏—Ö –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–æ—Ü–∏–∞–ª—å–Ω–æ–π –∏–Ω–∂–µ–Ω–µ—Ä–∏–∏

##### –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞—â–∏—Ç–∞:

- –ò—Å—Ç–æ—Ä–∏—è –ø–∞—Ä–æ–ª–µ–π: –∑–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö 5 –ø–∞—Ä–æ–ª–µ–π (remember=5)
- –õ–∏–º–∏—Ç –ø–æ–ø—ã—Ç–æ–∫: 3 –ø–æ–ø—ã—Ç–∫–∏ –≤–≤–æ–¥–∞ –ø–∞—Ä–æ–ª—è (retry=3)
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–¥–±–æ—Ä–∞: obscuring –∏ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ yescrypt

### PAM Script –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –¥–æ—Å—Ç—É–ø–∞

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≤—Ö–æ–¥–æ–≤/–≤—ã—Ö–æ–¥–æ–≤ –≤ /var/log/pam_scripts.log

#### –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ:

- –í—Ä–µ–º—è –∏ –¥–∞—Ç–∞ –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞
- –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∏—Å—Ç–æ—á–Ω–∏–∫ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
- –°–µ—Ä–≤–∏—Å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (SSH, login)

#### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è —á–µ—Ä–µ–∑ pam_exec –¥–ª—è sshd –∏ login

# –£—Å—Ç–∞–Ω–æ–≤–∫–∞

## –ó–∞–ø—É—Å–∫ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω—ã

- `cd debian-vm`
- `vagrant up`

## –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø–æ SSH

- `vagrant ssh`

## –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π

- `vagrant reload --provision`

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

- `vagrant ssh -c "getent passwd | grep -E '(sysadmin|helpdesk|netadmin)'"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ —è–¥—Ä–∞

- `vagrant ssh -c "sysctl net.core.bpf_jit_harden kernel.kptr_restrict"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–æ–≤

- `vagrant ssh -c "systemctl status nginx"`
- `vagrant ssh -c "iptables -L -n"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ chroot

- `vagrant ssh -c "ls -la /srv/chroot/"`

# –†–∞–±–æ—Ç–∞ —Å setup_kernel_security_automation

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—á–µ—Ç–∞

- `vagrant ssh -c "cat /etc/kernel-security/reports/weekly-report-20250921.md"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã —Å–ª—É–∂–±—ã

- `vagrant ssh -c "systemctl status kernel-security.timer"`
- `vagrant ssh -c "systemctl status kernel-security.service"`

## –ó–∞–ø—É—Å–∫ –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

- `vagrant ssh -c "/etc/kernel-security/automator.sh run"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

- `vagrant ssh -c "sysctl net.core.bpf_jit_harden kernel.kptr_restrict kernel.dmesg_restrict"`

## –ó–∞–ø—É—Å–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

- `vagrant ssh -c "/etc/kernel-security/automator.sh fix"`

## –ü—Ä–æ—Å–º–æ—Ç—Ä –ª–æ–≥–æ–≤ –∞–≤—Ç–æ–º–∞—Ç–æ—Ä–∞

- `vagrant ssh -c "journalctl -u kernel-security.service -f"`

## –†—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫ –ø–µ—Ä–µ–∫–æ–º–ø–∏–ª—è—Ü–∏–∏ —è–¥—Ä–∞

- `vagrant ssh -c "sudo /etc/kernel-security/actions/kernel-recompile.sh"`

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ PAM

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–∏–º–∏—Ç–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

- `vagrant ssh -c "sudo -u john bash -c 'ulimit -u'"`
- `vagrant ssh -c "sudo -u john bash -c 'ulimit -Hu'"`
- `vagrant ssh -c "sudo -u sysadmin bash -c 'ulimit -u'"`
- `vagrant ssh -c "sudo -u netadmin bash -c 'ulimit -u'"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ PAM cracklib –ø–∞—Ä–æ–ª—å–Ω–æ–π –ø–æ–ª–∏—Ç–∏–∫–∏

- `vagrant ssh -c "sudo cat /etc/pam.d/common-password | head -10"`
- `vagrant ssh -c "echo 'john:123' | sudo chpasswd"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ PAM script –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

- `vagrant ssh -c "ls -la /usr/local/bin/login_notify.sh"`
- `vagrant ssh -c "sudo grep login_notify /etc/pam.d/sshd /etc/pam.d/login"`
- `vagrant ssh -c "sudo tail -10 /var/log/pam_scripts.log"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ sudo –¥–ª—è john –±–µ–∑ –ø–∞—Ä–æ–ª—è + –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

- `vagrant ssh -c "sudo -l -U john"`
- `vagrant ssh -c "sudo -u john sudo whoami"`
- `vagrant ssh -c "sudo -u john sudo echo '–¢–µ—Å—Ç –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è'"`
- `vagrant ssh -c "sudo tail -5 /var/log/sudo.log"`

## –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏

- `vagrant ssh -c "sudo ls -la /vagrant/scripts/"`
- `vagrant ssh -c "sudo tail -20 /var/log/security_setup.log"`
